<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking History - Railway Express</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="app-header animate-fade-in">
            <div class="header-inner">
                <div class="brand">
                    <div class="brand-mark" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16v-2"/>
                            <line x1="12" y1="22" x2="12" y2="12"/>
                        </svg>
                    </div>
                    <div class="brand-text">
                        <div class="brand-title">Railway Express</div>
                        <div class="brand-subtitle">Your Booking History</div>
                    </div>
                </div>
            </div>
        </header>

        <main class="app-main animate-slide-in">
            {% include 'navbar.html' %}

            <div class="page-head">
                <div>
                    <h1 class="page-title">Booking History</h1>
                    <p class="page-subtitle">View and manage all your past and upcoming bookings</p>
                </div>
                <div class="page-actions">
                    <a class="btn btn-primary" href="{{ url_for('index') }}">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                        New Booking
                    </a>
                </div>
            </div>

            <div class="section">
                <div class="section-head">
                    <h2 class="section-title">Your Bookings ({{ bookings|length }})</h2>
                    <div style="display: flex; gap: var(--spacing-3);">
                        <div style="display: flex; align-items: center; gap: var(--spacing-2); padding: var(--spacing-2) var(--spacing-3); background: var(--success-100); border-radius: var(--radius-full);">
                            <div style="width: 10px; height: 10px; background: var(--success-500); border-radius: var(--radius-full);"></div>
                            <span class="muted small">Confirmed</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: var(--spacing-2); padding: var(--spacing-2) var(--spacing-3); background: var(--warning-100); border-radius: var(--radius-full);">
                            <div style="width: 10px; height: 10px; background: var(--warning-500); border-radius: var(--radius-full);"></div>
                            <span class="muted small">Pending</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: var(--spacing-2); padding: var(--spacing-2) var(--spacing-3); background: var(--danger-100); border-radius: var(--radius-full);">
                            <div style="width: 10px; height: 10px; background: var(--danger-500); border-radius: var(--radius-full);"></div>
                            <span class="muted small">Cancelled</span>
                        </div>
                    </div>
                </div>

                {% if bookings %}
                <div style="display: flex; flex-direction: column; gap: var(--spacing-5);">
                    {% for booking in bookings %}
                    <div class="card animate-fade-in booking-card booking-status-{{ booking.get('Status', 'Confirmed').lower() }}" data-animation-delay="{{ loop.index0 * 0.05 }}s">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--spacing-5); padding-bottom: var(--spacing-4); border-bottom: 1px solid var(--neutral-200);">
                            <div>
                                <div style="display: flex; align-items: center; gap: var(--spacing-3); margin-bottom: var(--spacing-2);">
                                    <div style="font-size: var(--text-xl); font-weight: var(--font-bold); color: var(--primary-700);">
                                        {{ booking.get('PNR', 'N/A') }}
                                    </div>
                                    <span class="pill {% if booking.get('Status', 'Confirmed') == 'Confirmed' %}pill-success{% elif booking.get('Status', 'Confirmed') == 'Pending' %}pill-warning{% else %}pill-danger{% endif %}">
                                        {{ booking.get('Status', 'Confirmed') }}
                                    </span>
                                </div>
                                <div style="font-weight: var(--font-semibold); font-size: var(--text-lg); color: var(--neutral-800);">
                                    {{ booking.get('TrainName', 'N/A') }}
                                </div>
                                <div class="muted">{{ booking.get('TrainID', 'N/A') }}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: var(--text-2xl); font-weight: var(--font-bold); color: var(--success-600); margin-bottom: var(--spacing-1);">
                                    ₹{{ booking.get('TotalFare', 0) }}
                                </div>
                                <div class="muted small">Total Fare</div>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--spacing-4); margin-bottom: var(--spacing-5);">
                            <div>
                                <div class="muted small">Route</div>
                                <div style="font-weight: var(--font-medium);">{{ booking.get('Route', 'N/A') }}</div>
                            </div>
                            <div>
                                <div class="muted small">Journey Date</div>
                                <div style="font-weight: var(--font-medium);">{{ booking.get('JourneyDate', 'N/A') }}</div>
                            </div>
                            <div>
                                <div class="muted small">Departure</div>
                                <div style="font-weight: var(--font-medium);">{{ booking.get('Time', 'N/A') }}</div>
                            </div>
                            <div>
                                <div class="muted small">Class</div>
                                <div>
                                    <span class="pill pill-primary">{{ booking.get('Class', 'N/A') }}</span>
                                </div>
                            </div>
                            <div>
                                <div class="muted small">Seats</div>
                                <div style="font-weight: var(--font-medium);">{{ booking.get('Seats', 'N/A') }}</div>
                            </div>
                            <div>
                                <div class="muted small">Booking Date</div>
                                <div style="font-weight: var(--font-medium);">{{ booking.get('BookingDate', '')[:10] }}</div>
                            </div>
                        </div>

                        {% if booking.get('BerthAllocations') %}
                        <div style="margin-top: var(--spacing-4); padding-top: var(--spacing-4); border-top: 1px solid var(--neutral-200);">
                            <div class="muted small" style="margin-bottom: var(--spacing-2);">Seat/Berth Allocations</div>
                            <div style="display: flex; flex-wrap: wrap; gap: var(--spacing-2);">
                                {% for berth in booking['BerthAllocations'] %}
                                <div style="background: var(--primary-100); color: var(--primary-800); padding: var(--spacing-2) var(--spacing-3); border-radius: var(--radius-lg); font-weight: var(--font-semibold); font-size: var(--text-sm); border: 1px solid var(--primary-200);">
                                    {{ berth.get('Coach', 'N/A') }}-{{ berth.get('Berth', 'N/A') }}
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}

                        <div style="margin-top: var(--spacing-5); padding-top: var(--spacing-4); border-top: 1px solid var(--neutral-200); text-align: right;">
                            <a href="{{ url_for('booking_success', booking_id=booking['BookingID']) }}" class="btn btn-primary">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                    <circle cx="12" cy="12" r="3"/>
                                </svg>
                                View Details
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="card empty animate-fade-in">
                    <div style="display: flex; justify-content: center; margin-bottom: var(--spacing-6);">
                        <div style="width: 80px; height: 80px; background: var(--neutral-100); border-radius: var(--radius-full); display: flex; align-items: center; justify-content: center;">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="color: var(--neutral-400);">
                                <path d="M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16v-2"/>
                                <line x1="12" y1="22" x2="12" y2="12"/>
                                <path d="m12 12 4.5-2.5"/>
                                <path d="m12 12-4.5-2.5"/>
                            </svg>
                        </div>
                    </div>
                    <div class="empty-title">No Bookings Yet</div>
                    <div class="empty-subtitle">You haven't made any bookings yet. Start planning your journey today!</div>
                    <div class="empty-actions">
                        <a class="btn btn-primary btn-lg" href="{{ url_for('index') }}">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="m21 21-4.35-4.35"/>
                            </svg>
                            Book Your First Train
                        </a>
                        <a class="btn btn-ghost" href="{{ url_for('dashboard') }}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="7" height="7"/>
                                <rect x="14" y="3" width="7" height="7"/>
                                <rect x="14" y="14" width="7" height="7"/>
                                <rect x="3" y="14" width="7" height="7"/>
                            </svg>
                            Go to Dashboard
                        </a>
                    </div>
                </div>
                {% endif %}
            </div>
        </main>

        <footer class="app-footer">
            <div class="footer-inner">
                <div>
                    <div style="font-weight: var(--font-semibold); color: var(--neutral-700); margin-bottom: var(--spacing-1);">Railway Express</div>
                    <div class="muted">© 2026 All rights reserved</div>
                </div>
                <div style="display: flex; gap: var(--spacing-6);">
                    <a href="#" class="link">Booking Policy</a>
                    <a href="#" class="link">Cancellation</a>
                    <a href="#" class="link">Support</a>
                </div>
            </div>
        </footer>
    </div>
    
    <script>
        // Apply animation delays from data attributes
        document.addEventListener('DOMContentLoaded', function() {
            const bookingCards = document.querySelectorAll('.booking-card');
            bookingCards.forEach(card => {
                const delay = card.dataset.animationDelay;
                if (delay) {
                    card.style.animationDelay = delay;
                }
            });
        });
    </script>
</body>
</html>
